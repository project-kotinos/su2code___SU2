# Edit - No sudo
dependencies:
  build:
    - anaconda3:latest

build_targets:
  - name: default
    environment:
      - SU2_RUN=/workspace/bin
      - SU2_HOME=/workspace/
    commands:
      - apt-get -y update
      - apt-get -y install autoconf build-essential libopenmpi-dev g++
      - conda config --add channels intel
      - conda install python=3.6 numpy scipy mpi4py swig
      - ./bootstrap
      - ./externals/autotools/bin/autoreconf -f -i
      - autoreconf -f -i
      - python ./preconfigure.py --prefix=/workspace/build --enable-PY_WRAPPER --disable-tecio
      - make -j 4
      - make install
      - bash testcase.sh
ci:
  builds:
    - name: build
      build_target: default

